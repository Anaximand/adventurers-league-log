<div class="row">
  <div class='col-xs-6'>
    <h3>Log Entries</h3>
  </div>
  <% if @log_entries.total_pages > 1 %>
    <div class='col-xs-9'>
      <%= paginate @log_entries %>
    </div>
   <% end %>

  <div class='col-xs-6'>
    <div class="pull-right">
      <% if @dm_logs_enabled %>
        <%= link_to "Exclude DM Logs", user_character_path(@user, @character), class: "btn btn-default" %>
      <% else %>
        <%= link_to "Include DM Logs", user_character_path(@user, @character, q:  { "s"=>"date_played asc" } ), class: "btn btn-default" %>
      <% end %>
      <div class="btn-group">
        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
          Print... <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu">
          <li><%= link_to "Print Full", print_user_character_path(@character.user, @character) %></li>
          <li><%= link_to "Print Condensed", print_condensed_user_character_path(@character.user, @character) %></li>
        </ul>
      </div>
      <% if @character.user == current_user %>
         <%= link_to "New Log Entry", new_user_character_character_log_entry_path(current_user, @character), class: "btn btn-primary" %>
      <% end %>
   </div>
  </div>
</div>

<div id='characters_list'>

  <div class="table-responsive">
    <table class="table table-bordered table-responsive table-striped">
      <tr>
        <th><%= sort_link @search, :date_played, "Date&nbsp;Played".html_safe, {}, {} %></th>
        <th><%= sort_link @search, :adventure_title, "Adventure&nbsp;Title".html_safe, {}, {} %></th>
        <th><%= sort_link @search, :session_num, "Session", {}, {} %></th>
        <th><%= sort_link @search, :xp_gained, "XP", {}, {} %></th>
        <th><%= sort_link @search, :gp_gained, "GP", {}, {} %></th>
        <th><%= sort_link @search, :desc_magic_items_gained, "Magic&nbsp;Items".html_safe, {}, {} %></th>
        <th><%= sort_link @search, :renown_gained, "Renown", {}, {} %></th>
        <th><%= sort_link @search, :downtime_gained, "Downtime", {}, {} %></th>
        <th></th>
      </tr>

      <tbody id='menu_items'>
        <% @log_entries.each do |log_entry| %>
          <tr>
            <td><%= log_entry.date_played %></td>
            <td>
              <% unless log_entry.type == "DmLogEntry" %>
                <%= link_to log_entry.adventure_title || "", user_character_character_log_entry_path(@character.user, @character, log_entry) %>
              <% else %>
                <%= log_entry.adventure_title %>
              <% end %>
            </td>
            <td><%= log_entry.session_num %></td>
            <td><%= log_entry.xp_gained %></td>
            <td><%= humanize_decimal log_entry.gp_gained %></td>
            <td><%= log_entry.desc_magic_items_gained %></td>
            <td><%= log_entry.renown_gained %></td>
            <td><%= log_entry.downtime_gained %></td>
            <td>
              <% unless log_entry.type == "DmLogEntry" %>
                <%= link_to "", user_character_character_log_entry_path(@character.user, @character, log_entry), class: "fa fa-eye" %>
                <% if @character.user == current_user %>
                  <%= link_to "", edit_user_character_character_log_entry_path(current_user, @character, log_entry), class: "fa fa-pencil-square-o" %>
                  <%= link_to "", user_character_character_log_entry_path(current_user, @character, log_entry), method: :delete, data: { confirm: "Are you sure you want to delete this log entry?" }, class: "fa fa-trash-o" %>
                <% end %>
              <% else %>
                <div class='label label-default'>DM Log</div>
              <% end %>
            </td>
          </tr>
          <% unless log_entry.notes.empty? %>
            <tr class="log-entry-notes">
              <td colspan='9'>
                <strong>Notes:</strong>
                <%= log_entry.notes %>
              </td>
            </tr>
          <% end %>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
